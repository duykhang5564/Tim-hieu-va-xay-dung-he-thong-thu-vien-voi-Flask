{% extends "layout.html" %}
{% block content %}
<div class="row justify-content-center">
  <div class="col-md-8">
    <div class="card">
      <div class="card-header"><h4>Sửa sách</h4></div>
      <div class="card-body">
        <form action="{{ url_for('update_book', id=book.id) }}" method="POST" enctype="multipart/form-data">
          
          <div class="mb-3 text-center">
            <label class="form-label">Ảnh bìa hiện tại</label><br>
            <img src="{{ url_for('static', filename='book_covers/' + book.image_file) }}" class="img-thumbnail" style="width: 150px; height: 210px; object-fit: cover;">
          </div>
          <div class="mb-3">
            <label class="form-label">Cập nhật ảnh bìa mới (Tùy chọn)</label>
            <input type="file" class="form-control" name="image_file" accept="image/png, image/jpeg, image/jpg">
          </div>
          
          <div class="mb-3"><label>Tiêu đề</label><input type="text" class="form-control" name="title" value="{{ book.title }}" required></div>
          <div class="row">
            <div class="col-md-4 mb-3"><label>Tác giả</label><select class="form-select" name="author_id">{% for a in authors %}<option value="{{ a.id }}" {% if a.id==book.author_id %}selected{% endif %}>{{ a.name }}</option>{% endfor %}</select></div>
            <div class="col-md-4 mb-3"><label>Thể loại</label><select class="form-select" name="category_id">{% for c in categories %}<option value="{{ c.id }}" {% if c.id==book.category_id %}selected{% endif %}>{{ c.name }}</option>{% endfor %}</select></div>
            <div class="col-md-4 mb-3"><label>Ngôn ngữ</label><select class="form-select" name="language_id">{% for l in languages %}<option value="{{ l.id }}" {% if l.id==book.language_id %}selected{% endif %}>{{ l.name }}</option>{% endfor %}</select></div>
          </div>
          <div class="row">
             <div class="col-md-4 mb-3"><label>Năm</label><input type="number" class="form-control" name="year" value="{{ book.year }}"></div>
             <div class="col-md-4 mb-3"><label>Giá</label><input type="number" class="form-control" name="price" value="{{ book.price }}"></div>
             <!--! <<< MỚI: Thêm ô Sửa Số lượng >>> -->
             <div class="col-md-4 mb-3">
                <label class="form-label">Tổng số lượng</label>
                <input type="number" class="form-control" name="quantity" value="{{ book.total_quantity }}" min="0">
             </div>
          </div>
          <div class="mb-3 mt-3"><label>Tóm tắt</label><textarea class="form-control" name="summary">{{ book.summary }}</textarea></div>
          <button class="btn btn-success">Cập nhật</button>
          <a href="{{ url_for('index') }}" class="btn btn-secondary">Hủy</a>
        </form>
      </div>
    </div>
  </div>
</div>
{% endblock %}